//~~WEBPATH~~/vz-projector/data.js
var Xc=0<=navigator.userAgent.toLowerCase().indexOf("firefox"),Yc=Ic()&&!Xc,Zc=["__next__","__seq_next__"];function $c(a){for(var b=null,c=0;c<Zc.length;c++){var d=Zc[c];if(d in a&&""!==a[d]){b=a[d];break}}return null==b?null:+b}
var ad=function(){function a(a,c){this.shuffledDataIndices=[];this.projections={};this.tSNEIteration=0;this.tSNEShouldStop=!0;this.dim=[0,0];this.hasTSNERun=!1;this.points=a;for(var b=yc(this.points.length),e=b.length,g,h;e;)h=Math.floor(Math.random()*e--),g=b[e],b[e]=b[h],b[h]=g;this.shuffledDataIndices=b;this.sequences=this.computeSequences(a);this.dim=[this.points.length,this.points[0].vector.length];this.spriteAndMetadataInfo=c}a.prototype.computeSequences=function(a){for(var b=new Int8Array(a.length),
d={},e=[],g=0;g<a.length;g++)if(!b[g]){b[g]=1;var h=$c(a[g].metadata);if(null!=h)if(h in d)h=d[h],h.pointIndices.unshift(g),d[g]=h;else{h={pointIndices:[]};d[g]=h;e.push(h);for(var k=g;a[k];)h.pointIndices.push(k),k=$c(a[k].metadata),null!=k?b[k]=1:k=-1}}return e};a.prototype.projectionCanBeRendered=function(a){return"tsne"!==a?!0:0<this.tSNEIteration};a.prototype.getSubset=function(b){var c=this;b=(null!=b&&0<b.length?b.map(function(a){return c.points[a]}):this.points).map(function(a){return{metadata:a.metadata,
index:a.index,vector:a.vector.slice(),projections:{}}});return new a(b,this.spriteAndMetadataInfo)};a.prototype.normalize=function(){var a=Rc(this.points,function(a){return a.vector});if(null==a)throw Error("centroid should not be null");for(var c=0;c<this.points.length;++c){var d=this.points[c];d.vector=Kc(d.vector,a);Oc(d.vector)}};a.prototype.projectLinear=function(a,c){this.projections[c]=!0;this.points.forEach(function(b){b.projections[c]=Jc(b.vector,a)})};a.prototype.projectPCA=function(){var a=
this;return null!=this.projections["pca-0"]?Promise.resolve(null):Fc("Computing PCA...",function(){var b=a.points[0].vector.length,d=a.shuffledDataIndices.map(function(b){return a.points[b].vector});200<b&&(d=Pc(d));for(var b=d.slice(0,5E4),b=numeric.div(numeric.dot(numeric.transpose(b),b),b.length),e=numeric.svd(b),g=e.S,h=0,b=0;b<g.length;++b)h+=g[b];for(b=0;b<g.length;++b)g[b]/=h;a.fracVariancesExplained=g;for(var k=e.U,d=d.map(function(a){for(var b=new Float32Array(10),c=0;10>c;c++){for(var d=
0,e=0;e<a.length;e++)d+=a[e]*k[e][c];b[c]=d}return b}),e=0;10>e;e++)for(g="pca-"+e,a.projections[g]=!0,b=0;b<d.length;b++)a.points[a.shuffledDataIndices[b]].projections[g]=d[b][e]})};a.prototype.projectTSNE=function(a,c,d,e){function b(){if(h.tSNEShouldStop)e(null),h.tsne=null;else{h.tsne.step();var a=h.tsne.getSolution();l.forEach(function(b,c){b=h.points[b];b.projections["tsne-0"]=a[c*d+0];b.projections["tsne-1"]=a[c*d+1];3===d&&(b.projections["tsne-2"]=a[c*d+2])});h.tSNEIteration++;e(h.tSNEIteration);
requestAnimationFrame(b)}}var h=this;this.hasTSNERun=!0;var k=Math.floor(3*a);this.tsne=new hc({epsilon:c,perplexity:a,dim:d});this.tSNEShouldStop=!1;this.tSNEIteration=0;var l=this.shuffledDataIndices.slice(0,1E4);null!=this.nearest&&k===this.nearestK?k=Promise.resolve(this.nearest):(a=l.map(function(a){return h.points[a]}),this.nearestK=k,k=Yc?Uc(a,k,function(a){return a.vector}):Vc(a,k,function(a){return a.vector},function(a,b){return 1-Jc(a,b)}));k.then(function(a){h.nearest=a;Fc("Initializing T-SNE...",
function(){h.tsne.initDataDist(h.nearest)}).then(b)})};a.prototype.mergeMetadata=function(a){var b=this;if(a.pointsInfo.length!==this.points.length){var d="Number of tensors ("+this.points.length+") do not match the number of lines in metadata"+(" ("+a.pointsInfo.length+").");if(1===a.stats.length&&this.points.length+1===a.pointsInfo.length)return lc(d+" Single column metadata should not have a header row.","merging metadata"),!1;if(1<a.stats.length&&this.points.length-1===a.pointsInfo.length)return lc(d+
" Multi-column metadata should have a header row with column labels.","merging metadata"),!1;mc(d)}this.spriteAndMetadataInfo=a;a.pointsInfo.slice(0,this.points.length).forEach(function(a,c){return b.points[c].metadata=a});return!0};a.prototype.stopTSNE=function(){this.tSNEShouldStop=!0};a.prototype.findNeighbors=function(a,c,d){return Wc(this.points,a,d,function(a){return a.vector},c).slice(0,d)};a.prototype.query=function(a,c,d){var b=Ec(a,c,d),g=[];this.points.forEach(function(a,c){b(a)&&g.push(c)});
return g};return a}();function bd(a,b,c,d){this.projectionType=a;this.projectionComponents=b;this.dimensionality=c;this.dataSet=d}function cd(){this.label="";this.isSelected=!1;this.tSNELearningRate=this.tSNEPerplexity=this.tSNEIteration=0;this.tSNEis3d=!0;this.pcaComponentDimensions=[];this.projections=[];this.selectedPoints=[]}
function dd(a,b){if(3<b.length)throw new RangeError("components length must be \x3c\x3d 3");var c=[null,null,null];a="custom"===a?"linear":a;for(var d=0;d<b.length;++d)null!=b[d]&&(c[d]=a+"-"+b[d]);return c};
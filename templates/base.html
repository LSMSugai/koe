{% load render_bundle from webpack_loader %}
{% load static %}
{% load custom_tags %}

<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>{% block title %}{% endblock %}</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Webpack rendered CSS -->
    {% render_bundle 'main' 'css' %}
    <style>
        #loading-spinner-modal {
            background: rgba(255, 255, 255, .8) url('{% static "images/loading-fading-squares.gif" %}') 50% 50% no-repeat;
        }
    </style>
</head>

<body>

<div class="vh-offset" id="content-wrapper">
    <iframe id="my_iframe" style="display:none;"></iframe>

    {# The nav`bar is supposed to be always on top#}
    <div id="navbar">
        <span class="navbar-brand" href="#">
            鳥声 KOE |
            {% get_navbar_urls as urls %}
            {% for url, text in urls.items %}
                {% if page == url %}
                    <span href="{% url url %}" class="navbar-link active">{{ text }}</span>
                {% else %}
                    <a href="{% url url %}" class="navbar-link">{{ text }}</a>
                {% endif %}
            {% endfor %}

        </span>

        {% block navbar-right %}
            {% if user.is_authenticated %}
                <span class="navbar-text">Hi {{ user.username }}
                    <a href="{% url 'logout' %}" class="navbar-link">Log out</a>
                </span>
            {% endif %}
        {% endblock %}
    </div>

    {% block main-content %}
        <div class="main-content">
            <div class="content-center">
                {% block content-center %}{% endblock %}
            </div>
        </div>
    {% endblock %}

</div>
<div class="offset-holder" id="content-wrapper-offset-holder" attr="height"></div>
<div id="max-vh"></div>

<div class="modal" id="loading-spinner-modal"></div>
<div class="modal fade in" id="dialog-modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel"
     aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="">
        <div class="modal-content" style="">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span
                        class="sr-only">Close</span>
                </button>
                <h3 class="modal-title"></h3>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer">
                <div class="btn-group btn-group-justified" role="group" aria-label="group button">
                    {% block modal-button %}
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-primary" data-dismiss="modal" role="button">No</button>
                        </div>
                        <div class="btn-group" role="group">
                            <button type="button" id="dialog-modal-yes-button" class="btn btn-primary btn-hover-green"
                                    role="button"> Yes
                            </button>
                        </div>
                    {% endblock %}
                </div>
            </div>
        </div>
    </div>
</div>

{% render_bundle 'main' 'js' 'JQUERY' %}
<!-- django-js-reverse -->
<script src="{% url 'js_reverse' %}" type="text/javascript"></script>

<!-- Webpack rendered Javascript -->
{% render_bundle 'main' 'js' %}

<!-- Common URL -->
<script>
    window.appCache = {};
    {% get_server_constants as constants %}

    var constants = {{ constants|safe }};
    for (var key in constants) {
        if (constants.hasOwnProperty(key)) {
            window.appCache[key] = Object.freeze(constants[key]);
        }
    }

</script>

{% block scripts %}{% endblock %}
</body>
</html>
